@using System.Net.Http
@using System.Threading.Tasks
@using TheradexPortal.Data
@using TheradexPortal.Data.PowerBI

@inject PbiInterop pbiInterop

<div @ref="@PowerBIElement" style="width:100%;height:80vh" />


@code {
    private ElementReference PowerBIElement;
    private IJSObjectReference? report;
    private bool isLoaded = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            report = await pbiInterop.EmbedFullReportJS("FullReport", PowerBIElement);
        }
    }

    public async Task Update()
    {
        if (report != null)
        {
            await pbiInterop.EmbedFullReportJS("FullReport", PowerBIElement);
        }
    }
}