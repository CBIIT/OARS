@using System.Diagnostics.CodeAnalysis
@using TheradexPortal.Data.Models;
@using TheradexPortal.Data.Services.Abstract;
@using TheradexPortal.Data.Static;
@inject IHttpContextAccessor httpContextAccessor
@layout AdminLayout
@page "/admin/dmu/fileupload"
<Field>
    <FieldLabel ColumnSize="ColumnSize.Is4" TextWeight="TextWeight.Bold">Select a file:</FieldLabel>
    <FieldBody ColumnSize="ColumnSize.Is4" Margin="Margin.IsAuto">
        <FilePicker Upload="@OnFileUpload" ShowMode="FilePickerShowMode.List" />
    </FieldBody>
 </Field>

@code {
    private string fileType;
    private FilePicker UploadField;
    [Inject] private IALSFileImportService alsFileImportService { get; set; }

    public async void OnFileUpload(FileUploadEventArgs e)
    {
        MemoryStream ms = new MemoryStream();
        try
        {
            await e.File.OpenReadStream(21500000).CopyToAsync(ms);
            alsFileImportService.ParseALSFile(ms, 0);
        }catch (Exception ex)
		{
			Console.WriteLine(ex.Message);
		}
    }
}
